<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>ä» 0 æ­å»º rollup + typescript + jest å·¥å…·åº“ | crise&#39;s blog</title>
    <meta name="generator" content="VuePress 1.9.7">
    <link rel="icon" href="./assets/logo.png">
    <meta name="description" content="ä¸€åç¨‹åºå‘˜/å‰ç«¯äººçš„æŠ€æœ¯åšå®¢">
    
    <link rel="preload" href="/assets/css/0.styles.1cd9ab6a.css" as="style"><link rel="preload" href="/assets/js/app.237e33b5.js" as="script"><link rel="preload" href="/assets/js/2.a6e094ff.js" as="script"><link rel="preload" href="/assets/js/4.9b118658.js" as="script"><link rel="prefetch" href="/assets/js/10.ed6b7b4f.js"><link rel="prefetch" href="/assets/js/11.33a35b98.js"><link rel="prefetch" href="/assets/js/12.545dcf20.js"><link rel="prefetch" href="/assets/js/13.0157a43a.js"><link rel="prefetch" href="/assets/js/14.6926c1c5.js"><link rel="prefetch" href="/assets/js/15.de7aef62.js"><link rel="prefetch" href="/assets/js/16.0b9d8c28.js"><link rel="prefetch" href="/assets/js/17.45f356c9.js"><link rel="prefetch" href="/assets/js/18.5e50c60e.js"><link rel="prefetch" href="/assets/js/19.d739307b.js"><link rel="prefetch" href="/assets/js/20.7d3dc31c.js"><link rel="prefetch" href="/assets/js/21.5f1ef20a.js"><link rel="prefetch" href="/assets/js/22.5864a5a2.js"><link rel="prefetch" href="/assets/js/23.ec78678c.js"><link rel="prefetch" href="/assets/js/24.316a50ac.js"><link rel="prefetch" href="/assets/js/25.e7923a60.js"><link rel="prefetch" href="/assets/js/26.fd02b552.js"><link rel="prefetch" href="/assets/js/27.0003fc19.js"><link rel="prefetch" href="/assets/js/28.fccb544e.js"><link rel="prefetch" href="/assets/js/29.21f2e63a.js"><link rel="prefetch" href="/assets/js/3.f3817cd8.js"><link rel="prefetch" href="/assets/js/30.f706c3a5.js"><link rel="prefetch" href="/assets/js/31.93eb136e.js"><link rel="prefetch" href="/assets/js/32.f1918a14.js"><link rel="prefetch" href="/assets/js/33.633fdfb4.js"><link rel="prefetch" href="/assets/js/34.1f46d635.js"><link rel="prefetch" href="/assets/js/35.a090b183.js"><link rel="prefetch" href="/assets/js/36.ea5de301.js"><link rel="prefetch" href="/assets/js/37.01ed1858.js"><link rel="prefetch" href="/assets/js/38.6c04b42d.js"><link rel="prefetch" href="/assets/js/39.61a2c924.js"><link rel="prefetch" href="/assets/js/40.cd078337.js"><link rel="prefetch" href="/assets/js/41.9d443262.js"><link rel="prefetch" href="/assets/js/42.4b91203f.js"><link rel="prefetch" href="/assets/js/43.415a3857.js"><link rel="prefetch" href="/assets/js/44.b4aaf64d.js"><link rel="prefetch" href="/assets/js/45.0175e1e7.js"><link rel="prefetch" href="/assets/js/46.76ddb299.js"><link rel="prefetch" href="/assets/js/47.24fc1119.js"><link rel="prefetch" href="/assets/js/48.d753a44d.js"><link rel="prefetch" href="/assets/js/49.d4b652dc.js"><link rel="prefetch" href="/assets/js/5.317978c4.js"><link rel="prefetch" href="/assets/js/50.6c2887ad.js"><link rel="prefetch" href="/assets/js/51.3d0febed.js"><link rel="prefetch" href="/assets/js/52.6996c471.js"><link rel="prefetch" href="/assets/js/53.d7277718.js"><link rel="prefetch" href="/assets/js/54.d89f5330.js"><link rel="prefetch" href="/assets/js/55.b3197515.js"><link rel="prefetch" href="/assets/js/56.98cd9448.js"><link rel="prefetch" href="/assets/js/57.ad53dd47.js"><link rel="prefetch" href="/assets/js/58.8c1618f3.js"><link rel="prefetch" href="/assets/js/59.94460e81.js"><link rel="prefetch" href="/assets/js/6.a0219e38.js"><link rel="prefetch" href="/assets/js/60.3b7da87f.js"><link rel="prefetch" href="/assets/js/61.e608e32a.js"><link rel="prefetch" href="/assets/js/62.1e131ad7.js"><link rel="prefetch" href="/assets/js/63.41ea7b98.js"><link rel="prefetch" href="/assets/js/64.4f7fd140.js"><link rel="prefetch" href="/assets/js/65.1c0798b5.js"><link rel="prefetch" href="/assets/js/66.7d7588f6.js"><link rel="prefetch" href="/assets/js/67.739991ea.js"><link rel="prefetch" href="/assets/js/68.f9b883d5.js"><link rel="prefetch" href="/assets/js/69.9edfe956.js"><link rel="prefetch" href="/assets/js/7.99a9934c.js"><link rel="prefetch" href="/assets/js/70.db60f31a.js"><link rel="prefetch" href="/assets/js/71.00b04458.js"><link rel="prefetch" href="/assets/js/72.5ee17ade.js"><link rel="prefetch" href="/assets/js/73.24fde59b.js"><link rel="prefetch" href="/assets/js/74.7d870932.js"><link rel="prefetch" href="/assets/js/75.75f6627d.js"><link rel="prefetch" href="/assets/js/76.ce1ead80.js"><link rel="prefetch" href="/assets/js/77.208f1a5c.js"><link rel="prefetch" href="/assets/js/8.9f6f4f79.js"><link rel="prefetch" href="/assets/js/9.abcfea03.js">
    <link rel="stylesheet" href="/assets/css/0.styles.1cd9ab6a.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">crise's blog</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/blog/" class="nav-link router-link-active">
  åšå®¢
</a></div><div class="nav-item"><a href="/algorithm/" class="nav-link">
  ç®—æ³•é¢˜åº“
</a></div><div class="nav-item"><a href="https://baidu.com" target="_blank" rel="noopener noreferrer" class="nav-link external">
  å¾®åš
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/blog/" class="nav-link router-link-active">
  åšå®¢
</a></div><div class="nav-item"><a href="/algorithm/" class="nav-link">
  ç®—æ³•é¢˜åº“
</a></div><div class="nav-item"><a href="https://baidu.com" target="_blank" rel="noopener noreferrer" class="nav-link external">
  å¾®åš
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>jsè¿›é˜¶</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>æµè§ˆå™¨</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading open"><span>å‰ç«¯å·¥ç¨‹åŒ–</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/blog/engineer/ui-fit.html" class="sidebar-link">ç§»åŠ¨ç«¯UIé€‚é…æ–¹æ¡ˆé€‰æ‹©</a></li><li><a href="/blog/engineer/cli.html" class="sidebar-link">ä» 0 æ‰“é€ å±äºè‡ªå·±çš„è„šæ‰‹æ¶</a></li><li><a href="/blog/engineer/vue3-template.html" class="sidebar-link">ä» 0 æ­å»º vue3+vite+typescript ä¼ä¸šçº§é¡¹ç›®</a></li><li><a href="/blog/engineer/library-template.html" aria-current="page" class="active sidebar-link">ä» 0 æ­å»º rollup + typescript + jest å·¥å…·åº“</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/blog/engineer/library-template.html#å‰è¨€" class="sidebar-link">å‰è¨€</a></li><li class="sidebar-sub-header"><a href="/blog/engineer/library-template.html#å®ç°çš„åŠŸèƒ½" class="sidebar-link">å®ç°çš„åŠŸèƒ½</a></li><li class="sidebar-sub-header"><a href="/blog/engineer/library-template.html#æ¨¡æ¿ä¾èµ–ç‰ˆæœ¬" class="sidebar-link">æ¨¡æ¿ä¾èµ–ç‰ˆæœ¬</a></li><li class="sidebar-sub-header"><a href="/blog/engineer/library-template.html#åˆå§‹åŒ–é¡¹ç›®" class="sidebar-link">åˆå§‹åŒ–é¡¹ç›®</a></li><li class="sidebar-sub-header"><a href="/blog/engineer/library-template.html#é…ç½®typescript" class="sidebar-link">é…ç½®Typescript</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/blog/engineer/library-template.html#å®‰è£…ä¾èµ–" class="sidebar-link">å®‰è£…ä¾èµ–</a></li><li class="sidebar-sub-header"><a href="/blog/engineer/library-template.html#å¢åŠ é…ç½®" class="sidebar-link">å¢åŠ é…ç½®</a></li><li class="sidebar-sub-header"><a href="/blog/engineer/library-template.html#é…ç½®tsconfig-json" class="sidebar-link">é…ç½®tsconfig.json</a></li></ul></li><li class="sidebar-sub-header"><a href="/blog/engineer/library-template.html#é›†æˆeslint" class="sidebar-link">é›†æˆeslint</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/blog/engineer/library-template.html#å®‰è£…" class="sidebar-link">å®‰è£…</a></li><li class="sidebar-sub-header"><a href="/blog/engineer/library-template.html#é…ç½®-eslintrc-js" class="sidebar-link">é…ç½® .eslintrc.js</a></li></ul></li><li class="sidebar-sub-header"><a href="/blog/engineer/library-template.html#é›†æˆ-prettier-ä¸éœ€è¦å°±è·³è¿‡" class="sidebar-link">é›†æˆ prettierï¼ˆä¸éœ€è¦å°±è·³è¿‡ï¼‰</a></li><li class="sidebar-sub-header"><a href="/blog/engineer/library-template.html#ä½¿ç”¨rollup" class="sidebar-link">ä½¿ç”¨rollup</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/blog/engineer/library-template.html#ä¸ºä»€ä¹ˆä¸ä½¿ç”¨webpack" class="sidebar-link">ä¸ºä»€ä¹ˆä¸ä½¿ç”¨webpackï¼Ÿ</a></li><li class="sidebar-sub-header"><a href="/blog/engineer/library-template.html#rollupæ’ä»¶" class="sidebar-link">rollupæ’ä»¶</a></li><li class="sidebar-sub-header"><a href="/blog/engineer/library-template.html#é…ç½®rollup-config-tsæ–‡ä»¶" class="sidebar-link">é…ç½®rollup.config.tsæ–‡ä»¶</a></li></ul></li><li class="sidebar-sub-header"><a href="/blog/engineer/library-template.html#é›†æˆ-husky-lint-staged" class="sidebar-link">é›†æˆ husky + lint-staged</a></li><li class="sidebar-sub-header"><a href="/blog/engineer/library-template.html#ä»£ç æäº¤è§„èŒƒç»Ÿä¸€" class="sidebar-link">ä»£ç æäº¤è§„èŒƒç»Ÿä¸€</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/blog/engineer/library-template.html#é›†æˆ-commitizen-å®ç°æäº¤è§„èŒƒ" class="sidebar-link">é›†æˆ Commitizen å®ç°æäº¤è§„èŒƒ</a></li><li class="sidebar-sub-header"><a href="/blog/engineer/library-template.html#é›†æˆ-commitlint-éªŒè¯æäº¤è§„èŒƒ" class="sidebar-link">é›†æˆ commitlint éªŒè¯æäº¤è§„èŒƒ</a></li></ul></li><li class="sidebar-sub-header"><a href="/blog/engineer/library-template.html#å•å…ƒæµ‹è¯•" class="sidebar-link">å•å…ƒæµ‹è¯•</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/blog/engineer/library-template.html#å®‰è£…ä¾èµ–-2" class="sidebar-link">å®‰è£…ä¾èµ–</a></li><li class="sidebar-sub-header"><a href="/blog/engineer/library-template.html#é…ç½®jest-config-jsæ–‡ä»¶" class="sidebar-link">é…ç½®jest.config.jsæ–‡ä»¶</a></li></ul></li><li class="sidebar-sub-header"><a href="/blog/engineer/library-template.html#å†™åœ¨æœ€å" class="sidebar-link">å†™åœ¨æœ€å</a></li></ul></li><li><a href="/blog/engineer/eslintrc.html" class="sidebar-link">ESLintä½¿ç”¨ã€åŸç†åŠé…ç½®è§„åˆ™è¯¦è§£</a></li><li><a href="/blog/engineer/vue2-vue3.html" class="sidebar-link">Vue2 ä¸ Vue3 çš„åŒºåˆ«</a></li><li><section class="sidebar-group is-sub-group depth-1"><p class="sidebar-heading"><span>tsç³»åˆ—</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/blog/engineer/tsconfig.html" class="sidebar-link">tsconfig.jsoné…ç½®è¯¦è§£</a></li></ul></section></li><li><section class="sidebar-group is-sub-group depth-1"><p class="sidebar-heading"><span>babelç³»åˆ—</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/blog/engineer/babel.html" class="sidebar-link">babel</a></li><li><a href="/blog/engineer/babel-plugin.html" class="sidebar-link">babelå¸¸ç”¨æ’ä»¶</a></li></ul></section></li></ul></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>æ€§èƒ½ä¼˜åŒ–</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>webè·¨ç«¯</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>node</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>æ¡†æ¶åŠåŸç†</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>å‰ç«¯å®‰å…¨</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>è®¡ç®—æœºåŸºç¡€</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>è¿ç»´ç›¸å…³</span> <span class="arrow right"></span></p> <!----></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="ä»-0-æ­å»º-rollup-typescript-jest-å·¥å…·åº“"><a href="#ä»-0-æ­å»º-rollup-typescript-jest-å·¥å…·åº“" class="header-anchor">#</a> ä» 0 æ­å»º rollup + typescript + jest å·¥å…·åº“</h1> <h2 id="å‰è¨€"><a href="#å‰è¨€" class="header-anchor">#</a> å‰è¨€</h2> <p>å…¬å¸ä¸åŒé¡¹ç›®ä¹‹é—´ç”±äºä¸šåŠ¡çš„å…³è”æ€§ï¼Œæ€»æ˜¯ä¼šæ²‰æ·€è®¸å¤šé€šç”¨çš„å·¥å…·æ–¹æ³•ä»¥åŠä¸šåŠ¡åŠŸèƒ½ï¼Œæˆ‘ä»¬å¯ä»¥æ­å»ºä¸€ä¸ªå·¥å…·åº“æ¥ç»™å„ä¸ªé¡¹ç›®ä½¿ç”¨ã€‚çœ‹äº†æœ¬æ–‡ï¼Œä½ èƒ½çŸ¥é“æ€ä¹ˆæ­å»ºä¸€ä¸ªç»Ÿä¸€çš„å·¥å…·åº“ï¼Œå¹¶ä¸”å­¦ä¼šåœ¨å·¥å…·åº“ä¸­ä½¿ç”¨rollupæ‰“åŒ…å·¥å…·é…ç½®babelã€tsã€commonjsç­‰åŠŸèƒ½æ’ä»¶ï¼ˆæœ¬æ–‡æ˜¯<a href="/blog/engineer/vue3_template.html">ä» 0 æ­å»º vue3+vite+typescript ä¼ä¸šçº§é¡¹ç›®</a>çš„å§Šå¦¹ç¯‡ï¼‰ã€‚</p> <h2 id="å®ç°çš„åŠŸèƒ½"><a href="#å®ç°çš„åŠŸèƒ½" class="header-anchor">#</a> å®ç°çš„åŠŸèƒ½</h2> <ul><li>tsä»£ç æ£€éªŒ</li> <li>å•å…ƒæµ‹è¯•åŠè¦†ç›–ç‡æ£€æµ‹</li> <li>æ‰“åŒ…æˆumdã€cmdã€esmæ ¼å¼ä»£ç </li> <li>å…¼å®¹ä¼ ç»Ÿæµè§ˆå™¨ï¼Œå¹¶æŒ‰éœ€åŠ è½½polyfill</li> <li>ç¼–è¾‘å™¨çš„å¿«é€Ÿè¡¥å…¨å’Œæç¤º</li> <li>è‡ªåŠ¨ç”Ÿæˆ changlog</li> <li>çº¦æŸç¼–ç é£æ ¼ã€ä¿å­˜æ ¼å¼åŒ–</li> <li>ä»£ç æäº¤å¼ºåˆ¶æ ¡éªŒ</li></ul> <h2 id="æ¨¡æ¿ä¾èµ–ç‰ˆæœ¬"><a href="#æ¨¡æ¿ä¾èµ–ç‰ˆæœ¬" class="header-anchor">#</a> æ¨¡æ¿ä¾èµ–ç‰ˆæœ¬</h2> <ul><li><code>nodeï¼š&gt;=v12.0.0</code></li> <li><code>rollupï¼š^2.55.0</code></li> <li><code>@rollup/plugin-babelï¼š^5.3.0</code></li> <li><code>@rollup/plugin-commonjsï¼š^19.0.2</code></li> <li><code>@rollup/plugin-jsonï¼š^4.1.0</code></li> <li><code>@rollup/plugin-node-resolveï¼š^13.0.4</code></li> <li><code>rollup-plugin-terserï¼š^7.0.2</code></li> <li><code>rollup-plugin-dtsï¼š^4.2.2</code></li> <li><code>typescriptï¼š^4.6.4</code></li> <li><code>@typescript-eslint/eslint-pluginï¼š^5.13.0</code></li> <li><code>@typescript-eslint/parserï¼š^5.13.0</code></li> <li><code>@babel/coreï¼š^7.14.8</code></li> <li><code>@babel/preset-envï¼š^7.14.8</code></li> <li><code>@babel/plugin-transform-runtimeï¼š^7.17.0</code></li> <li><code>@babel/preset-typescriptï¼š^7.18.6</code></li> <li><code>babel-plugin-polyfill-corejs3ï¼š^0.5.2</code></li> <li><code>prettierï¼š^2.5.1</code></li> <li><code>eslintï¼š^8.10.0</code></li> <li><code>eslint-config-airbnb-base: ^15.0.0</code></li> <li><code>eslint-plugin-importï¼š^2.25.4</code></li> <li><code>eslint-import-resolver-aliasï¼š^1.1.2</code></li> <li><code>eslint-config-prettierï¼š^8.5.0</code></li> <li><code>eslint-plugin-prettierï¼š^4.0.0</code></li> <li><code>jestï¼š^28.1.0</code></li> <li><code>ts-jestï¼š^28.0.8</code></li> <li><code>@types/jestï¼š^27.5.0</code></li> <li><code>@jest/globalsï¼š^28.0.3</code></li></ul> <h2 id="åˆå§‹åŒ–é¡¹ç›®"><a href="#åˆå§‹åŒ–é¡¹ç›®" class="header-anchor">#</a> åˆå§‹åŒ–é¡¹ç›®</h2> <p>æ–°å»ºä¸€ä¸ªé¡¹ç›®ç›®å½•å¦‚ utils , å¹¶ npm init -y åˆå§‹åŒ–é¡¹ç›®ã€‚</p> <div class="language-sh extra-class"><pre class="language-sh"><code><span class="token function">mkdir</span> utils <span class="token operator">&amp;&amp;</span> <span class="token builtin class-name">cd</span> utils
<span class="token function">npm</span> init -y
</code></pre></div><h2 id="é…ç½®typescript"><a href="#é…ç½®typescript" class="header-anchor">#</a> é…ç½®Typescript</h2> <h3 id="å®‰è£…ä¾èµ–"><a href="#å®‰è£…ä¾èµ–" class="header-anchor">#</a> å®‰è£…ä¾èµ–</h3> <div class="language-sh extra-class"><pre class="language-sh"><code><span class="token function">pnpm</span> <span class="token function">install</span> typescript
</code></pre></div><p>åˆ›å»º <code>types</code> ç›®å½•ä½œä¸ºç±»å‹å£°æ˜æ–‡ä»¶ç®¡ç†ç›®å½•</p> <div class="language-bash extra-class"><pre class="language-bash"><code>utils
 <span class="token operator">|</span>
 <span class="token operator">|</span>- src
 	 <span class="token operator">|</span>- global.d.ts
 <span class="token operator">|</span>- tsconfig.json
</code></pre></div><h3 id="å¢åŠ é…ç½®"><a href="#å¢åŠ é…ç½®" class="header-anchor">#</a> å¢åŠ é…ç½®</h3> <p>åœ¨é¡¹ç›®æ ¹ç›®å½•æ–°å¢<code>.vscode</code>æ–‡ä»¶å¤¹ï¼Œåœ¨ä¸‹æ–°å¢<code>settings.json</code>æ–‡ä»¶ã€‚</p> <div class="language-json extra-class"><pre class="language-json"><code><span class="token punctuation">{</span>
  <span class="token property">&quot;typescript.tsdk&quot;</span><span class="token operator">:</span> <span class="token string">&quot;./node_modules/typescript/lib&quot;</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>
</code></pre></div><p>æ–°å¢è¿™è¡Œé…ç½®ã€‚æ„ä¹‰æ˜¯é¡¹ç›®ä¸­vscodeä½¿ç”¨çš„tsçš„sdkè·¯å¾„æ˜¯æˆ‘ä»¬ä¾èµ–ä¸­çš„tsï¼Œä¸æ˜¯vscodeå†…ç½®çš„tsç‰ˆæœ¬ï¼ä¿è¯å›¢é˜Ÿä½¿ç”¨çš„éƒ½æ˜¯åŒä¸€ä¸ª<code>ts sdk</code>ã€‚</p> <h3 id="é…ç½®tsconfig-json"><a href="#é…ç½®tsconfig-json" class="header-anchor">#</a> é…ç½®tsconfig.json</h3> <div class="language-json extra-class"><pre class="language-json"><code><span class="token punctuation">{</span>
    <span class="token comment">/* åŸºç¡€é…ç½® */</span>
    <span class="token property">&quot;compilerOptions&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token comment">// ç¼–è¯‘è¿‡ç¨‹ä¸­éœ€è¦å¼•å…¥çš„åº“æ–‡ä»¶çš„åˆ—è¡¨</span>
        <span class="token property">&quot;lib&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">&quot;esnext&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;dom&quot;</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
        <span class="token comment">// ç¼–è¯‘åçš„ç›®æ ‡ç‰ˆæœ¬</span>
        <span class="token property">&quot;target&quot;</span><span class="token operator">:</span> <span class="token string">&quot;esnext&quot;</span><span class="token punctuation">,</span>
        <span class="token comment">// ç¼–è¯‘åä»£ç éµå¾ªçš„è§„èŒƒ</span>
        <span class="token property">&quot;module&quot;</span><span class="token operator">:</span> <span class="token string">&quot;esnext&quot;</span><span class="token punctuation">,</span>
        <span class="token comment">// å¯ç”¨å®ƒä¼šé˜»æ­¢Typescriptå¯¹å¯¼å…¥çš„åº“è¿›è¡Œç±»å‹æ£€æŸ¥</span>
        <span class="token property">&quot;skipLibCheck&quot;</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>

        <span class="token comment">/* å¼ºç±»å‹æ£€æŸ¥é…ç½® */</span>
        <span class="token comment">// ä¸¥æ ¼æ¨¡å¼, å¼ºçƒˆå»ºè®®å¼€å¯ï¼Œå¦‚æœä¸å¼€å¯ï¼ŒTSå°±æ²¡æœ‰æ„ä¹‰äº†</span>
        <span class="token property">&quot;strict&quot;</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
        <span class="token comment">// æŒ‡å®š jsx ä»£ç çš„ç”Ÿæˆ: 'preserve', 'react-native', or 'react'</span>
        <span class="token property">&quot;jsx&quot;</span><span class="token operator">:</span> <span class="token string">&quot;preserve&quot;</span><span class="token punctuation">,</span>
        <span class="token comment">// å¿…é¡»æ ‡æ³¨ä¸ºnullç±»å‹,æ‰å¯ä»¥èµ‹å€¼ä¸ºnull</span>
        <span class="token property">&quot;strictNullChecks&quot;</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
        <span class="token comment">// trueï¼šåœ¨è¡¨è¾¾å¼å’Œå£°æ˜ä¸Šæœ‰éšå«çš„ anyç±»å‹æ—¶æŠ¥é”™</span>
        <span class="token property">&quot;noImplicitAny&quot;</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
        <span class="token comment">// ä¸º trueï¼Œå…è®¸ä»æ²¡æœ‰è®¾ç½®é»˜è®¤å¯¼å‡ºçš„æ¨¡å—ä¸­é»˜è®¤å¯¼å…¥ã€‚è¿™å¹¶ä¸å½±å“ä»£ç çš„æ˜¾ç¤ºï¼Œä»…ä¸ºäº†ç±»å‹æ£€æŸ¥ã€‚</span>
        <span class="token property">&quot;allowSyntheticDefaultImports&quot;</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
        <span class="token comment">// ç”¨æ¥æŒ‡å®šæ˜¯å¦å…è®¸ç¼–è¯‘JSæ–‡ä»¶ï¼Œé»˜è®¤false,å³ä¸ç¼–è¯‘JSæ–‡ä»¶</span>
        <span class="token comment">// &quot;allowJs&quot;: true,</span>
        <span class="token comment">// å½“thisè¡¨è¾¾å¼çš„å€¼ä¸ºanyç±»å‹çš„æ—¶å€™ï¼Œç”Ÿæˆä¸€ä¸ªé”™è¯¯</span>
        <span class="token property">&quot;noImplicitThis&quot;</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>

        <span class="token comment">/* æ¨¡å—åˆ†æé…ç½® */</span>
        <span class="token comment">// æ­¤å¤„è®¾ç½®ä¸ºnode,æ‰èƒ½è§£æimport xx from 'xx'</span>
        <span class="token property">&quot;moduleResolution&quot;</span><span class="token operator">:</span> <span class="token string">&quot;node&quot;</span><span class="token punctuation">,</span>
        <span class="token comment">// å…è®¸æˆ‘ä»¬åœ¨ TypeScript æ¨¡å—ä¸­å¯¼å…¥ JSON æ–‡ä»¶</span>
        <span class="token property">&quot;resolveJsonModule&quot;</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
        <span class="token comment">// å…¼å®¹æ¨¡å¼ï¼šå°† CommonJSæ–‡ä»¶ çš„æ‰€æœ‰å¯¼å‡ºåˆå¹¶ä½œä¸ºä¸€ä¸ª default exportï¼Œæ”¯æŒä½¿ç”¨import XX from 'XX'è¯­æ³•å¯¼å…¥ CommonJS æ¨¡å—ã€‚è¾…åŠ©è§£å†³ESæ¨¡å—ä¸­å¼•å…¥CommonJsæ¨¡å—æ—¶çš„é—®é¢˜ï¼Œä¸»è¦é’ˆå¯¹ESMä¸­æœ‰é»˜è®¤å¯¼å‡ºè€ŒCommonJsæ²¡æœ‰ã€‚</span>
        <span class="token property">&quot;esModuleInterop&quot;</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
        <span class="token comment">// é…ç½®ç±»å‹å£°æ˜æ–‡ä»¶`d.ts`çš„æŸ¥æ‰¾è·¯å¾„ã€‚é»˜è®¤åœ¨node_modulesä¸‹çš„@typesé‡Œé¢æŸ¥æ‰¾ã€‚</span>
        <span class="token property">&quot;typeRoots&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">&quot;./node_modules/@types/&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;./types/&quot;</span><span class="token punctuation">]</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token property">&quot;include&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">&quot;./src/**/*.ts&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;./types/*.d.ts&quot;</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token property">&quot;exclude&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">&quot;node_modules&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;dist&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;docs&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;coverage&quot;</span><span class="token punctuation">]</span>
<span class="token punctuation">}</span>
</code></pre></div><h2 id="é›†æˆeslint"><a href="#é›†æˆeslint" class="header-anchor">#</a> é›†æˆeslint</h2> <p>TypeScirpt ä»2019å¹´å¼€å§‹ä¾¿å·²å…¨é¢é‡‡ç”¨<code>ESLint</code>ä½œä¸ºä»£ç æ£€æµ‹å·¥å…·ã€‚å¹¶ä¸”æä¾›äº† TypeScript æ–‡ä»¶çš„è§£æå™¨ <a href="https://github.com/typescript-eslint/typescript-eslint/tree/main/packages/parser" target="_blank" rel="noopener noreferrer">@typescript-eslint/parser<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> å’Œ é€‰é¡¹é…ç½®æ’ä»¶ <a href="https://github.com/typescript-eslint/typescript-eslint/tree/main/packages/eslint-plugin" target="_blank" rel="noopener noreferrer">@typescript-eslint/eslint-plugin<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>ã€‚</p> <p>è¯¦ç»†æè¿°å¯ä»¥æŸ¥çœ‹ <a href="https://eslint.org/blog/2019/01/future-typescript-eslint/" target="_blank" rel="noopener noreferrer">the future of TypeScript on ESLint<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>ã€‚</p> <h3 id="å®‰è£…"><a href="#å®‰è£…" class="header-anchor">#</a> å®‰è£…</h3> <div class="language-sh extra-class"><pre class="language-sh"><code><span class="token function">pnpm</span> i eslint @typescript-eslint/parser @typescript-eslint/eslint-plugin -D
<span class="token comment"># pnpm i eslint @typescript-eslint/parser @typescript-eslint/eslint-plugin eslint-plugin-import eslint-import-resolver-typescript -D</span>
</code></pre></div><h3 id="é…ç½®-eslintrc-js"><a href="#é…ç½®-eslintrc-js" class="header-anchor">#</a> é…ç½® .eslintrc.js</h3> <div class="language-js extra-class"><pre class="language-js"><code>module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">root</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
    <span class="token literal-property property">env</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token literal-property property">browser</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
        <span class="token literal-property property">node</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
        <span class="token literal-property property">es6</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token literal-property property">parser</span><span class="token operator">:</span> <span class="token string">'@typescript-eslint/parser'</span><span class="token punctuation">,</span>
    <span class="token literal-property property">parserOptions</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token literal-property property">ecmaVersion</span><span class="token operator">:</span> <span class="token string">'latest'</span><span class="token punctuation">,</span>
        <span class="token literal-property property">parser</span><span class="token operator">:</span> <span class="token string">'@typescript-eslint/parser'</span><span class="token punctuation">,</span>
        <span class="token literal-property property">sourceType</span><span class="token operator">:</span> <span class="token string">'module'</span><span class="token punctuation">,</span>
        <span class="token literal-property property">ecmaFeatures</span><span class="token operator">:</span> <span class="token punctuation">{</span>
            <span class="token literal-property property">jsx</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token literal-property property">plugins</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">'@typescript-eslint'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token keyword">extends</span><span class="token operator">:</span> <span class="token punctuation">[</span>
        <span class="token string">'eslint:recommended'</span><span class="token punctuation">,</span>
        <span class="token string">'plugin:@typescript-eslint/recommended'</span><span class="token punctuation">,</span>
    <span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token literal-property property">rules</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token string-property property">'import/prefer-default-export'</span><span class="token operator">:</span> <span class="token string">'off'</span><span class="token punctuation">,</span>
        <span class="token string-property property">'global-require'</span><span class="token operator">:</span> <span class="token string">'off'</span><span class="token punctuation">,</span>
        <span class="token string-property property">'import/export'</span><span class="token operator">:</span> <span class="token string">'off'</span><span class="token punctuation">,</span>
        <span class="token string-property property">'@typescript-eslint/ban-ts-comment'</span><span class="token operator">:</span> <span class="token string">'off'</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token literal-property property">globals</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token literal-property property">system</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token comment">// parserOptions: {</span>
    <span class="token comment">//   project: './tsconfig.json',</span>
    <span class="token comment">// },</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

</code></pre></div><p>å¦‚éœ€äº†è§£eslintåŸç†åŠå…·ä½“é…ç½®è§„åˆ™ï¼Œè¯·ç‚¹å‡»<a href="/blog/engineer/eslintrc.html">ESLintä½¿ç”¨ã€åŸç†åŠé…ç½®è§„åˆ™è¯¦è§£</a></p> <h2 id="é›†æˆ-prettier-ä¸éœ€è¦å°±è·³è¿‡"><a href="#é›†æˆ-prettier-ä¸éœ€è¦å°±è·³è¿‡" class="header-anchor">#</a> é›†æˆ prettierï¼ˆä¸éœ€è¦å°±è·³è¿‡ï¼‰</h2> <div class="custom-block tip"><p class="custom-block-title">TIP</p> <ol><li><code>prettier</code>ä¸»è¦è´Ÿè´£: é£æ ¼æ£€æŸ¥, æ²¡æœ‰è´¨é‡æ£€æŸ¥ã€‚è™½ç„¶ eslint æœ¬èº«åªæä¾›äº†éƒ¨åˆ†é£æ ¼æ£€æŸ¥ï¼Œä½†æ˜¯è¿™å¯¼è‡´æœ‰éƒ¨åˆ†çš„ä»£ç ä¾ç„¶æ²¡æœ‰å®ç°é£æ ¼æ£€æŸ¥ï¼Œå…·ä½“ç»†èŠ‚ä¸‹é¢ä¼šè¯´ã€‚å¯¹äºå¤§å¤šæ•°å®é™…é¡¹ç›®ï¼Œéƒ½ä¼šä½¿ç”¨<code>prettier</code>è¿›è¡Œé£æ ¼æ£€æŸ¥ã€‚ç”±äºä¼šå‡ºç°å¼•å…¥å¤šä¸ªé£æ ¼æ£€æŸ¥çš„æ’ä»¶å’Œé…ç½® lintï¼Œè¿™å°±å¯¼è‡´å­˜åœ¨éƒ¨åˆ†ä¼šä¸ prettier çš„ lint å‡ºç°å†²çªï¼Œå› æ­¤éœ€è¦ lint é¢„è®¾åŒ…ã€‚</li> <li><code>eslint-config-prettier</code>ï¼Œè¿™ä¸ªåŒ…çš„ä½œç”¨æ˜¯å…ˆå…³é—­è¿™äº›ä¸ prettier å†²çªçš„ lint è§„åˆ™ï¼Œç„¶åä¹‹åå†å¯ç”¨ prettier çš„è§„åˆ™ï¼Œä½¿å¾—å†²çªçš„ lint è§„åˆ™ä»¥ prettier ä¸ºå‡†ã€‚</li> <li><code>eslint-plugin-prettier</code>æ’ä»¶ä¼šè°ƒç”¨<code>prettier</code>å¯¹ä½ çš„ä»£ç é£æ ¼è¿›è¡Œæ£€æŸ¥ï¼Œå…¶åŸç†æ˜¯å…ˆä½¿ç”¨ prettier å¯¹ä½ çš„ä»£ç è¿›è¡Œæ ¼å¼åŒ–ï¼Œç„¶åä¸æ ¼å¼åŒ–ä¹‹å‰çš„ä»£ç è¿›è¡Œå¯¹æ¯”ï¼Œå¦‚æœè¿‡å‡ºç°äº†ä¸ä¸€è‡´ï¼Œè¿™ä¸ªåœ°æ–¹å°±ä¼šè¢« prettier è¿›è¡Œæ ‡è®°ã€‚</li></ol></div> <ol><li>å®‰è£…</li></ol> <div class="language-sh extra-class"><pre class="language-sh"><code><span class="token function">pnpm</span> i prettier eslint-config-prettier eslint-plugin-prettier -D
</code></pre></div><ol start="2"><li>åˆ›å»ºé…ç½®æ–‡ä»¶ï¼š <code>prettier.config.js</code> æˆ– <code>.prettierrc.js</code> æˆ– <code>.prettierrc</code></li></ol> <details class="custom-block details"><summary>ç‚¹å‡»æŸ¥çœ‹ä»£ç </summary> <div class="language-js extra-class"><pre class="language-js"><code>module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token comment">// ä¸€è¡Œæœ€å¤š 80 å­—ç¬¦</span>
  <span class="token literal-property property">printWidth</span><span class="token operator">:</span> <span class="token number">80</span><span class="token punctuation">,</span>
  <span class="token comment">// ä½¿ç”¨ 4 ä¸ªç©ºæ ¼ç¼©è¿›</span>
  <span class="token literal-property property">tabWidth</span><span class="token operator">:</span> <span class="token number">2</span><span class="token punctuation">,</span>
  <span class="token comment">// ä¸ä½¿ç”¨ tab ç¼©è¿›ï¼Œè€Œä½¿ç”¨ç©ºæ ¼</span>
  <span class="token literal-property property">useTabs</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
  <span class="token comment">// è¡Œå°¾éœ€è¦æœ‰åˆ†å·</span>
  <span class="token literal-property property">semi</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
  <span class="token comment">// ä½¿ç”¨å•å¼•å·ä»£æ›¿åŒå¼•å·</span>
  <span class="token literal-property property">singleQuote</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
  <span class="token comment">// å¯¹è±¡çš„ key ä»…åœ¨å¿…è¦æ—¶ç”¨å¼•å·</span>
  <span class="token literal-property property">quoteProps</span><span class="token operator">:</span> <span class="token string">&quot;as-needed&quot;</span><span class="token punctuation">,</span>
  <span class="token comment">// jsx ä¸ä½¿ç”¨å•å¼•å·ï¼Œè€Œä½¿ç”¨åŒå¼•å·</span>
  <span class="token literal-property property">jsxSingleQuote</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
  <span class="token comment">// æœ«å°¾ä½¿ç”¨é€—å·</span>
  <span class="token literal-property property">trailingComma</span><span class="token operator">:</span> <span class="token string">&quot;all&quot;</span><span class="token punctuation">,</span>
  <span class="token comment">// å¤§æ‹¬å·å†…çš„é¦–å°¾éœ€è¦ç©ºæ ¼ { foo: bar }</span>
  <span class="token literal-property property">bracketSpacing</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
  <span class="token comment">// jsx æ ‡ç­¾çš„åå°–æ‹¬å·éœ€è¦æ¢è¡Œ</span>
  <span class="token literal-property property">jsxBracketSameLine</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
  <span class="token comment">// ç®­å¤´å‡½æ•°ï¼Œåªæœ‰ä¸€ä¸ªå‚æ•°çš„æ—¶å€™ï¼Œä¹Ÿéœ€è¦æ‹¬å·</span>
  <span class="token literal-property property">arrowParens</span><span class="token operator">:</span> <span class="token string">&quot;always&quot;</span><span class="token punctuation">,</span>
  <span class="token comment">// æ¯ä¸ªæ–‡ä»¶æ ¼å¼åŒ–çš„èŒƒå›´æ˜¯æ–‡ä»¶çš„å…¨éƒ¨å†…å®¹</span>
  <span class="token literal-property property">rangeStart</span><span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
  <span class="token literal-property property">rangeEnd</span><span class="token operator">:</span> <span class="token number">Infinity</span><span class="token punctuation">,</span>
  <span class="token comment">// æ˜¯å¦éœ€è¦å†™æ–‡ä»¶å¼€å¤´çš„ @prettier</span>
  <span class="token literal-property property">requirePragma</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
  <span class="token comment">// æ˜¯å¦è‡ªåŠ¨åœ¨æ–‡ä»¶å¼€å¤´æ’å…¥ @prettier</span>
  <span class="token literal-property property">insertPragma</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
  <span class="token comment">// ä½¿ç”¨é»˜è®¤çš„æŠ˜è¡Œæ ‡å‡†</span>
  <span class="token literal-property property">proseWrap</span><span class="token operator">:</span> <span class="token string">&quot;preserve&quot;</span><span class="token punctuation">,</span>
  <span class="token comment">// æ ¹æ®æ˜¾ç¤ºæ ·å¼å†³å®š html è¦ä¸è¦æŠ˜è¡Œ</span>
  <span class="token literal-property property">htmlWhitespaceSensitivity</span><span class="token operator">:</span> <span class="token string">&quot;css&quot;</span><span class="token punctuation">,</span>
  <span class="token comment">// æ¢è¡Œç¬¦ä½¿ç”¨ lf</span>
  <span class="token literal-property property">endOfLine</span><span class="token operator">:</span> <span class="token string">&quot;lf&quot;</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre></div></details> <ol start="3"><li>ä¿®æ”¹ <code>.eslintrc.js</code> é…ç½®</li></ol> <details class="custom-block details"><summary>ç‚¹å‡»æŸ¥çœ‹ä»£ç </summary> <div class="language-js extra-class"><pre class="language-js"><code>module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
    <span class="token operator">...</span>
    <span class="token literal-property property">plugins</span><span class="token operator">:</span> <span class="token punctuation">[</span>
      <span class="token operator">...</span>
      <span class="token string">'prettier'</span>
    <span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token keyword">extends</span><span class="token operator">:</span> <span class="token punctuation">[</span>
        <span class="token operator">...</span>
        <span class="token string">'prettier'</span><span class="token punctuation">,</span>
        <span class="token string">'plugin:prettier/recommended'</span>
    <span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token operator">...</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre></div></details> <p>æ›´å¤šé…ç½®ï¼Œå¯ä»¥æŸ¥çœ‹<a href="https://prettier.io/docs/en/options.html#print-width" target="_blank" rel="noopener noreferrer">Prettier Options<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>
åœ¨è®¾ç½®ä¸­ï¼Œæœç´¢ <code>save</code> ï¼Œå‹¾é€‰ <code>Format On Save</code>ï¼š
<img src="/assets/img/save.afaab03c.png" alt="format on save">
ç„¶ååœ¨ <code>.vscodeæ–‡ä»¶å¤¹</code>ä¸‹çš„ <code>setting.json</code> ä¸­å¢åŠ é…ç½®ï¼š</p> <div class="language-json extra-class"><pre class="language-json"><code>  <span class="token property">&quot;editor.codeActionsOnSave&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token property">&quot;source.fixAll&quot;</span><span class="token operator">:</span> <span class="token boolean">true</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token property">&quot;[javascript]&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">&quot;editor.defaultFormatter&quot;</span><span class="token operator">:</span> <span class="token string">&quot;dbaeumer.vscode-eslint&quot;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token property">&quot;[typescript]&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">&quot;editor.defaultFormatter&quot;</span><span class="token operator">:</span> <span class="token string">&quot;dbaeumer.vscode-eslint&quot;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token property">&quot;editor.defaultFormatter&quot;</span><span class="token operator">:</span> <span class="token string">&quot;esbenp.prettier-vscode&quot;</span>
</code></pre></div><p>æŒ‡å®šé»˜è®¤æ ¼å¼åŒ–å·¥å…·å¾ˆé‡è¦ã€‚å³ä½¿ä½ çš„eslintä»¥åŠå…¶ä»–é…ç½®é¡¹éƒ½å¯¹ï¼Œä½†æ˜¯ä¿å­˜çš„æ—¶å€™ä»£ç é—ªæ¥é—ªå»é‚£è¯´æ˜ä½ çš„é»˜è®¤æ ¼å¼åŒ–å·¥å…·ä¸æ­£ç¡®ã€‚</p> <h2 id="ä½¿ç”¨rollup"><a href="#ä½¿ç”¨rollup" class="header-anchor">#</a> ä½¿ç”¨rollup</h2> <h3 id="ä¸ºä»€ä¹ˆä¸ä½¿ç”¨webpack"><a href="#ä¸ºä»€ä¹ˆä¸ä½¿ç”¨webpack" class="header-anchor">#</a> ä¸ºä»€ä¹ˆä¸ä½¿ç”¨webpackï¼Ÿ</h3> <p>ä¸€è¯´åˆ°æ‰“åŒ…å·¥å…·å¤§å®¶éƒ½æƒ³åˆ°webpackï¼Œå› ä¸ºæˆ‘ä»¬ç”¨åˆ°çš„vueï¼Œreactè„šæ‰‹æ¶éƒ½æ˜¯åŸºäºwebpackçš„ã€‚webpack çš„ä¸€ä¸ªç†å¿µæ˜¯â€œä¸‡ç‰©çš†æ˜¯æ¨¡å—â€ï¼Œåœ¨æ­¤ç†å¿µä¸‹ï¼Œä»–æœ‰å„ç§loaderï¼Œèƒ½å¤Ÿå¸®åŠ©æˆ‘ä»¬å¤„ç†å„ç±»èµ„æºï¼Œè¿™é’ˆå¯¹äºå¼€å‘æ„å»º <code>webåº”ç”¨</code> æ˜¯å¾ˆæœ‰æ•ˆçš„ï¼Œ<code>5.x</code>ç‰ˆæœ¬ å¼•å…¥çš„<a href="https://webpack.docschina.org/concepts/module-federation" target="_blank" rel="noopener noreferrer">æ¨¡å—è”é‚¦<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>æ›´æ˜¯å¥ åŸºäº†<code>å¾®åº”ç”¨</code>æ—¶ä»£çš„éœ¸ä¸»åœ°ä½ã€‚ä½†æ˜¯ä»–ç”Ÿæˆä»£ç æœ‰å¾ˆå¤šä¸æ˜¯æˆ‘ä»¬æ‰€å†™çš„é€»è¾‘ä»£ç ï¼Œæ¯”å¦‚ä¸€äº›ä»–è‡ªæœ‰çš„æ¨¡å—åŠ è½½åŠŸèƒ½:
<img src="https://img-blog.csdnimg.cn/img_convert/62b1963191e66e3e5b4c33ff73570c7a.png" alt="webpackæ¨¡å—ä»£ç ">
å¦‚æœä½ è¦å¼€å‘jsåº“ï¼Œé‚£webpackçš„ç¹çå’Œæ‰“åŒ…åçš„æ–‡ä»¶ä½“ç§¯å°±ä¸å¤ªé€‚ç”¨äº†ã€‚æœ‰éœ€æ±‚å°±æœ‰å·¥å…·ï¼Œæ‰€ä»¥rollupçš„äº§ç”Ÿå°±æ˜¯é’ˆå¯¹å¼€å‘jsåº“çš„ã€‚</p> <p><a href="https://rollupjs.org/guide/en/" target="_blank" rel="noopener noreferrer">rollup<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>æ˜¯ä¸€ä¸ªâ€œJavaScriptæ¨¡å—æ‰“åŒ…å™¨â€ï¼Œè‡´åŠ›äºå°†å°å—çš„ä»£ç ç¼–è¯‘æˆå¤§çš„å¤æ‚çš„ä»£ç ã€‚ç›¸æ¯”äº webpackï¼Œrollup.jsçš„ä¼˜åŠ¿åœ¨äºï¼š</p> <ul><li>api ç®€å•ï¼Œå­¦ä¹ æˆæœ¬ä½ã€‚</li> <li>å› ä¸ºä¸“æ³¨æ„å»ºå‡ºçš„ä»£ç ä½“ç§¯æ›´å°ã€‚ï¼ˆæ„å»ºç»“æœå°±æ˜¯çº¯çº¯çš„ jsï¼Œå¹¶ä¸ä¼šè¢« <code>__webpack_require__</code> ä¹‹ç±»çš„ä»£ç å¢åŠ ä»£ç é‡ï¼‰</li> <li>vue/react/angularç­‰è®¸å¤šæµè¡Œåº“éƒ½åœ¨ç”¨ä»–ä½œä¸ºæ‰“åŒ…å·¥å…·ï¼Œçƒ­é—¨å·¥å…· <code>vite</code> é‡‡ç”¨äº†å®ƒå½“ç”Ÿäº§æ„å»ºå·¥å…·ã€‚ï¼ˆæœ€è¿‘å„å¤§å‚éƒ½åœ¨çº·çº·è¯•æ°´ <code>vite</code> è½åœ°ï¼Œä¸èƒ½ä¸è¯´æ˜¯ä¸ªæœºä¼šå§ï¼Ÿï¼‰</li> <li>å¦‚æœéœ€è¦ï¼Œä»–å¯ä»¥åŒæ—¶å¸®æˆ‘ä»¬ç”Ÿæˆæ”¯æŒ <code>umd/commonjs/es</code>çš„jsä»£ç </li></ul> <h3 id="rollupæ’ä»¶"><a href="#rollupæ’ä»¶" class="header-anchor">#</a> rollupæ’ä»¶</h3> <p>æˆ‘ä»¬éœ€è¦å¯¹rollupæ·»åŠ ä¸€äº›è‡ªå®šä¹‰çš„é…ç½®ï¼Œä»¥æ‰©å±•rollupèƒ½åŠ›ã€‚</p> <ul><li>å°† CommonJS æ¨¡å—è½¬æ¢ä¸º ES6</li> <li>ä½¿ç”¨<code>node è§£æç®—æ³•</code>è§£æ<code>esm</code>è·¯å¾„å</li> <li>é›†æˆbabelï¼Œå°†ä»£ç è½¬è¯‘æˆes5ä»£ç ï¼Œä»¥é€‚åº”ä¼ ç»Ÿæµè§ˆå™¨</li> <li>å¯¹<code>esm</code>è·¯å¾„åä½¿ç”¨aliasåˆ«å</li> <li>è‡ªåŠ¨å¯¼å‡ºtsç±»å‹å£°æ˜æ–‡ä»¶</li></ul> <h4 id="rollup-plugin-commonjsæ’ä»¶"><a href="#rollup-plugin-commonjsæ’ä»¶" class="header-anchor">#</a> @rollup/plugin-commonjsæ’ä»¶</h4> <div class="custom-block tip"><p class="custom-block-title">TIP</p> <p>å®˜æ–¹æ–‡æ¡£ç®€ä»‹ï¼šå°† CommonJS æ¨¡å—è½¬æ¢ä¸º ES6ï¼Œè¿™æ ·å®ƒä»¬å°±å¯ä»¥åŒ…å«åœ¨ Rollup åŒ…ä¸­ã€‚</p></div> <p>æˆ‘ç»™ç¿»è¯‘ä¸‹ï¼š<strong>rollup.js é»˜è®¤æ”¯æŒçš„æ˜¯ esm æ ¼å¼çš„æ¨¡å—åŒ–ï¼Œä½†æœ‰äº†å®ƒï¼Œä½ å°±èƒ½åœ¨é¡¹ç›®é‡Œå¯¼å…¥ commonjs æ ¼å¼çš„æ–‡ä»¶/æ¨¡å—ã€‚</strong>ã€‚</p> <p>ä¸¾ä¸ªğŸŒ°ï¼š</p> <p>æœ‰ä¸¤ä¸ªæ–‡ä»¶ï¼Œåˆ†åˆ«æ˜¯ <code>index.js</code> å’Œ <code>utils.js</code>ã€‚</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// utils.js</span>
module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token number">42</span>
</code></pre></div><p><code>utils.js</code> çš„å¯¼å‡ºæ¨¡å¼ <code>module.exports</code> æ˜¯ <code>commonjs</code> æ ¼å¼çš„ã€‚</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// index.js</span>
<span class="token keyword">import</span> utils <span class="token keyword">from</span> <span class="token string">&quot;./utils&quot;</span><span class="token punctuation">;</span>

<span class="token keyword">export</span> <span class="token keyword">const</span> <span class="token function-variable function">printUtils</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">the utils is </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>utils<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre></div><p>å½“æˆ‘ä»¬æ²¡æœ‰ä½¿ç”¨æ’ä»¶ï¼Œç›´æ¥æ‹¿rollupè¿›è¡Œæ‰“åŒ…æ—¶ï¼Œæ§åˆ¶å°ä¼šç›´æ¥æŠ¥é”™ï¼š
<code>Error: 'default' is not exported by utils.js</code></p> <p>ä¹Ÿå°±æ˜¯è¯´ï¼š<code>utils.js</code> æ‰€ä½¿ç”¨çš„ <code>commonjs</code> çš„å¯¼å‡ºæ–¹å¼ï¼Œå†³å®šäº†å®ƒæ— æ³•è¢«æ™®é€šjsæ­£å¸¸importã€‚å› æ­¤ï¼Œæˆ‘ä»¬éœ€è¦<code>@rollup/plugin-commonjs</code>æ’ä»¶æ¥å¯¼å…¥commonjsæ ¼å¼çš„æ–‡ä»¶/æ¨¡å—ã€‚
å¼•å…¥ä¹‹åï¼Œç„¶åæ‰“åŒ…ï¼š
<img src="/assets/img/commonjs-result.bde6dce1.png" alt="commonjsè¾“å‡º">
commonjsæ ¼å¼çš„æ–‡ä»¶ï¼Œä¾¿è¢«æ­£å¸¸æ‰“åŒ…åˆ°è¾“å‡ºæ–‡ä»¶ä¸­ã€‚</p> <h4 id="rollup-plugin-node-resolveæ’ä»¶"><a href="#rollup-plugin-node-resolveæ’ä»¶" class="header-anchor">#</a> @rollup/plugin-node-resolveæ’ä»¶</h4> <div class="custom-block tip"><p class="custom-block-title">TIP</p> <p>å®˜æ–¹æ–‡æ¡£ç®€ä»‹ï¼šä½¿ç”¨ <a href="http://nodejs.cn/api/modules.html#all-together" target="_blank" rel="noopener noreferrer">node è§£æç®—æ³•<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> æ¥å®šä½æ¨¡å—ï¼Œç”¨äºä½¿ç”¨ node_modules ä¸­çš„ç¬¬ä¸‰æ–¹æ¨¡å—ã€‚</p></div> <p>rollup.js é»˜è®¤çš„æ–‡ä»¶å®šä½æ–¹å¼å±äº <code>esm</code>ï¼Œä¸èƒ½ç›´æ¥è§£æ<code>ts</code>åç¼€åæ–‡ä»¶ã€‚</p> <p>ä¸¾ä¸ªğŸŒ°ï¼š</p> <p>æ¯”å¦‚ï¼š<code>src/index.ts</code>ç›®å½•ä¸‹å¼•ç”¨äº†<code>utils.ts</code>æ–‡ä»¶ã€‚</p> <p>å½“æˆ‘ä»¬æ²¡æœ‰ä½¿ç”¨æ’ä»¶ï¼Œç›´æ¥æ‹¿rollupè¿›è¡Œæ‰“åŒ…æ—¶ï¼Œæ§åˆ¶å°ä¼šç›´æ¥æŠ¥é”™ï¼š
<code>Error: Could not resolve './environment' from src/index.ts</code>ã€‚</p> <p>åœ¨ <code>@rollup/plugin-node-resolve</code> æ’ä»¶çš„å¸®åŠ©ä¸‹ï¼Œæ‰èƒ½æˆåŠŸå‘½ä¸­ 'src/environment.ts' æ–‡ä»¶ã€‚</p> <h4 id="rollup-plugin-babelæ’ä»¶"><a href="#rollup-plugin-babelæ’ä»¶" class="header-anchor">#</a> @rollup/plugin-babelæ’ä»¶</h4> <div class="custom-block tip"><p class="custom-block-title">TIP</p> <p>å®˜æ–¹æ–‡æ¡£ç®€ä»‹ï¼šä¸€ä¸ª Rollup æ’ä»¶ï¼Œç”¨äº Rollup å’Œ Babel ä¹‹é—´çš„æ— ç¼é›†æˆã€‚</p></div> <p>ç†Ÿæ‚‰ Babel çš„åŒå­¦åº”è¯¥å¾ˆå®¹æ˜“æ˜ç™½å®ƒçš„ç”¨é€”ï¼Œä½¿ç”¨æœ¬æ’ä»¶ï¼Œå¯ä»¥é€šè¿‡ Babel çš„èƒ½åŠ›å°†ä½ æ‰€å†™çš„ es6/es7 ä»£ç ç¼–è¯‘è½¬æ¢ä¸º es5 çš„ï¼Œä»¥é€‚ç”¨ä¼ ç»Ÿæµè§ˆå™¨ã€‚</p> <p>ä¸¾ä¸ªğŸŒ°ï¼š</p> <p>æ¯”å¦‚ï¼š<code>src/index.js</code>ç¼–å†™å¦‚ä¸‹ä»£ç ï¼š</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> <span class="token function-variable function">sleep</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">seconds</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">Promise</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">resolve</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span> <span class="token function">resolve</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> seconds<span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token keyword">export</span> <span class="token keyword">const</span> <span class="token function-variable function">printUtils</span> <span class="token operator">=</span> <span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">await</span> <span class="token function">sleep</span><span class="token punctuation">(</span><span class="token number">3000</span><span class="token punctuation">)</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'I am awake...'</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre></div><ul><li>ä¸ä½¿ç”¨æ’ä»¶æ‰“åŒ…å‡ºæ¥çš„ä»£ç ï¼šåŸºæœ¬æ²¡æœ‰å˜åŒ–ï¼Œè¿˜æ˜¯æœ‰ async å’Œ awaitã€‚</li> <li>ä½¿ç”¨æ’ä»¶æ‰“åŒ…å‡ºæ¥çš„ä»£ç ï¼šæ²¡æœ‰ await å’Œ async äº†ï¼Œç¼–è¯‘æˆäº†å…¼å®¹æ€§æ›´å¼ºçš„ä»£ç ã€‚</li></ul> <h4 id="rollup-plugin-aliasæ’ä»¶"><a href="#rollup-plugin-aliasæ’ä»¶" class="header-anchor">#</a> @rollup/plugin-aliasæ’ä»¶</h4> <div class="custom-block tip"><p class="custom-block-title">TIP</p> <p>å®˜æ–¹æ–‡æ¡£ç®€ä»‹ï¼šä¸€ä¸ªåœ¨æ„ä»¶åŒ…æ—¶å®šä¹‰â€œåˆ«åâ€çš„ Rollup æ’ä»¶ã€‚</p></div> <p>ç¿»è¯‘æˆäººè¯ä¹Ÿå°±æ˜¯ï¼šä½¿ç”¨è¿™ä¸ªæ’ä»¶ï¼Œä½ å¯ä»¥åœ¨å¼•å…¥æ–‡ä»¶æ—¶ï¼Œä½¿ç”¨ä¸€ä¸ª <code>åˆ«å</code> æ¥ä»£æ›¿åŸæœ‰çš„é‚£äº›å›ºå®šçš„è·¯å¾„ã€‚</p> <p>ä¸¾ä¸ªğŸŒ°ï¼š</p> <p>æ¯”å¦‚ï¼š<code>src/index.js</code>ç¼–å†™å¦‚ä¸‹ä»£ç ï¼š</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">import</span> utils <span class="token keyword">from</span> <span class="token string">&quot;@/utils&quot;</span>

<span class="token keyword">export</span> <span class="token keyword">const</span> <span class="token function-variable function">printUtils</span> <span class="token operator">=</span> <span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">utils is </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>utils<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre></div><ul><li>ä¸ä½¿ç”¨æ’ä»¶æ‰“åŒ…ä¹‹åçš„äº§ç‰©ä¸­<code>@/utils</code>æ²¡æœ‰è§£æåˆ°å¯¹åº”çš„æ–‡ä»¶</li></ul> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">import</span> utils <span class="token keyword">from</span> <span class="token string">&quot;@/utils&quot;</span>

<span class="token keyword">const</span> <span class="token function-variable function">printUtils</span> <span class="token operator">=</span> <span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">answer is </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>answer<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">export</span> <span class="token punctuation">{</span> printUtils <span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre></div><ul><li>ä½¿ç”¨æ’ä»¶æ‰“åŒ…ä¹‹åï¼Œ<code>@/utils</code>èƒ½å¤Ÿè§£æ</li></ul> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">var</span> utils <span class="token operator">=</span> <span class="token number">42</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> <span class="token function-variable function">printUtils</span> <span class="token operator">=</span> <span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">answer is </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>utils<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">export</span> <span class="token punctuation">{</span> printUtils <span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre></div><h4 id="rollup-plugin-dtsæ’ä»¶"><a href="#rollup-plugin-dtsæ’ä»¶" class="header-anchor">#</a> rollup-plugin-dtsæ’ä»¶</h4> <div class="custom-block tip"><p class="custom-block-title">TIP</p> <p>å®˜æ–¹æ–‡æ¡£ç®€ä»‹ï¼šä¸€ä¸ªå¯ä»¥è‡ªåŠ¨å¯¼å‡º <code>.d.ts</code> çš„ Rollup æ’ä»¶ã€‚</p></div> <p>psï¼šè¯¥æ’ä»¶ä¼šè‡ªåŠ¨å°†ä»»ä½•å¤–éƒ¨åº“ï¼ˆ@typesä¾‹å¦‚ï¼‰æ ‡è®°ä¸ºexternalï¼Œå› æ­¤è¿™äº›åº“å°†è¢«æ’é™¤åœ¨æ†ç»‘ä¹‹å¤–</p> <h3 id="é…ç½®rollup-config-tsæ–‡ä»¶"><a href="#é…ç½®rollup-config-tsæ–‡ä»¶" class="header-anchor">#</a> é…ç½®rollup.config.tsæ–‡ä»¶</h3> <div class="language-ts extra-class"><pre class="language-ts"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> nodeResolve <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'@rollup/plugin-node-resolve'</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> dts <span class="token keyword">from</span> <span class="token string">'rollup-plugin-dts'</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> json <span class="token keyword">from</span> <span class="token string">'@rollup/plugin-json'</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> commonjs <span class="token keyword">from</span> <span class="token string">'@rollup/plugin-commonjs'</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> terser <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'rollup-plugin-terser'</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> babel <span class="token keyword">from</span> <span class="token string">'@rollup/plugin-babel'</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> path <span class="token keyword">from</span> <span class="token string">'path'</span><span class="token punctuation">;</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">[</span>
    <span class="token punctuation">{</span>
        input<span class="token operator">:</span> path<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">'./src/index.ts'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        output<span class="token operator">:</span> <span class="token punctuation">{</span>
            name<span class="token operator">:</span> <span class="token string">'UTILS'</span><span class="token punctuation">,</span>
            file<span class="token operator">:</span> <span class="token string">'dist/index.umd.js'</span><span class="token punctuation">,</span>
            format<span class="token operator">:</span> <span class="token string">'umd'</span><span class="token punctuation">,</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        plugins<span class="token operator">:</span> <span class="token punctuation">[</span>
            <span class="token function">nodeResolve</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
                browser<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
                extensions<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">'.js'</span><span class="token punctuation">,</span> <span class="token string">'.ts'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
            <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
            <span class="token function">commonjs</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
            <span class="token function">json</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
            <span class="token function">babel</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
                babelrc<span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
                babelHelpers<span class="token operator">:</span> <span class="token string">'runtime'</span><span class="token punctuation">,</span>
                exclude<span class="token operator">:</span> <span class="token string">'node_modules/**'</span><span class="token punctuation">,</span>
                extensions<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">'.js'</span><span class="token punctuation">,</span> <span class="token string">'.ts'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
            <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
            <span class="token function">terser</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">{</span>
        input<span class="token operator">:</span> path<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">'./src/index.ts'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        output<span class="token operator">:</span> <span class="token punctuation">[</span>
            <span class="token punctuation">{</span>
                file<span class="token operator">:</span> <span class="token string">'dist/index.cjs.js'</span><span class="token punctuation">,</span>
                format<span class="token operator">:</span> <span class="token string">'cjs'</span><span class="token punctuation">,</span>
            <span class="token punctuation">}</span><span class="token punctuation">,</span>
            <span class="token punctuation">{</span>
                file<span class="token operator">:</span> <span class="token string">'dist/index.esm.js'</span><span class="token punctuation">,</span>
                format<span class="token operator">:</span> <span class="token string">'es'</span><span class="token punctuation">,</span>
            <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token punctuation">]</span><span class="token punctuation">,</span>
        plugins<span class="token operator">:</span> <span class="token punctuation">[</span>
            <span class="token function">nodeResolve</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
                modulesOnly<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
                extensions<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">'.js'</span><span class="token punctuation">,</span> <span class="token string">'.ts'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
            <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
            <span class="token function">commonjs</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
            <span class="token function">babel</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
                babelrc<span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
                babelHelpers<span class="token operator">:</span> <span class="token string">'runtime'</span><span class="token punctuation">,</span>
                exclude<span class="token operator">:</span> <span class="token string">'node_modules/**'</span><span class="token punctuation">,</span>
                extensions<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">'.js'</span><span class="token punctuation">,</span> <span class="token string">'.ts'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
            <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
            <span class="token function">terser</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">{</span>
        input<span class="token operator">:</span> <span class="token string">'./src/index.ts'</span><span class="token punctuation">,</span>
        output<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">{</span> file<span class="token operator">:</span> <span class="token string">'dist/index.d.ts'</span><span class="token punctuation">,</span> format<span class="token operator">:</span> <span class="token string">'es'</span> <span class="token punctuation">}</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
        plugins<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token function">dts</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">]</span><span class="token punctuation">;</span>

</code></pre></div><h2 id="é›†æˆ-husky-lint-staged"><a href="#é›†æˆ-husky-lint-staged" class="header-anchor">#</a> é›†æˆ husky + lint-staged</h2> <ol><li>å®‰è£… husky</li></ol> <p><code>husky</code> æ˜¯ä¸€ä¸ªä¸º git å®¢æˆ·ç«¯å¢åŠ  <code>hook</code> çš„å·¥å…·ã€‚å®‰è£…åï¼Œå®ƒä¼šè‡ªåŠ¨åœ¨ä»“åº“ä¸­çš„ <code>.git/</code> ç›®å½•ä¸‹å¢åŠ ç›¸åº”çš„é’©å­ï¼›æ¯”å¦‚ <code>pre-commit</code> é’©å­å°±ä¼šåœ¨ä½ æ‰§è¡Œ <code>git commit</code> çš„è§¦å‘ã€‚</p> <p>é‚£ä¹ˆæˆ‘ä»¬å¯ä»¥åœ¨ <code>pre-commit</code> ä¸­å®ç°ä¸€äº›æ¯”å¦‚ <code>lint æ£€æŸ¥</code>ã€<code>å•å…ƒæµ‹è¯•</code>ã€<code>ä»£ç ç¾åŒ–</code>ç­‰æ“ä½œã€‚å½“ç„¶ï¼Œ<code>pre-commit</code> é˜¶æ®µæ‰§è¡Œçš„å‘½ä»¤å½“ç„¶è¦ä¿è¯å…¶é€Ÿåº¦ä¸è¦å¤ªæ…¢ï¼Œæ¯æ¬¡ commit éƒ½ç­‰å¾ˆä¹…ä¹Ÿä¸æ˜¯ä»€ä¹ˆå¥½çš„ä½“éªŒã€‚</p> <div class="language-bash extra-class"><pre class="language-bash"><code>npx husky-init <span class="token operator">&amp;&amp;</span> <span class="token function">npm</span> <span class="token function">install</span>
</code></pre></div><p>è¿™è¡Œå‘½ä»¤åšäº†å››ä»¶äº‹ï¼š</p> <ul><li>å®‰è£… husky åˆ°å¼€å‘ä¾èµ–</li> <li>åœ¨é¡¹ç›®æ ¹ç›®å½•ä¸‹åˆ›å»º .husky ç›®å½•</li> <li>åœ¨ .husky ç›®å½•åˆ›å»º pre-commit hookï¼Œå¹¶åˆå§‹åŒ– pre-commit å‘½ä»¤ä¸º npm test</li> <li>ä¿®æ”¹ package.json çš„ scriptsï¼Œå¢åŠ  &quot;prepare&quot;: &quot;husky install&quot;</li></ul> <p>å®‰è£…æˆåŠŸåä¼šå‘ç°é¡¹ç›®ä¸­å¤šäº†ä¸€ä¸ª<code>.husky</code>æ–‡ä»¶å¤¹:
<img src="/assets/img/husky.0551ac8e.png" alt="husky"></p> <p>åˆ°è¿™é‡Œï¼Œhusky é…ç½®å®Œæ¯•ï¼Œç°åœ¨æˆ‘ä»¬æ¥ä½¿ç”¨å®ƒï¼š</p> <p>husky åŒ…å«å¾ˆå¤š <code>hook</code>ï¼ˆé’©å­ï¼‰ï¼Œå¸¸ç”¨æœ‰ï¼š<code>pre-commit</code>ã€<code>commit-msg</code>ã€<code>pre-push</code>ã€‚è¿™é‡Œï¼Œæˆ‘ä»¬ä½¿ç”¨ pre-commit æ¥è§¦å‘ ESLint å‘½ä»¤ã€‚</p> <p>ä¿®æ”¹ .husky/pre-commit hook æ–‡ä»¶çš„è§¦å‘å‘½ä»¤ï¼š</p> <div class="language-sh extra-class"><pre class="language-sh"><code>eslint --fix ./src --ext .vue,.js,.ts
</code></pre></div><p>ä¸Šé¢è¿™ä¸ª <code>pre-commit</code> hook æ–‡ä»¶çš„ä½œç”¨æ˜¯ï¼š</p> <p>å½“æˆ‘ä»¬æ‰§è¡Œ <code>git commit -m &quot;xxx&quot;</code> æ—¶ï¼Œä¼šå…ˆå¯¹ src ç›®å½•ä¸‹æ‰€æœ‰çš„ .vueã€.jsã€.ts  æ–‡ä»¶æ‰§è¡Œ eslint --fix å‘½ä»¤ï¼Œå¦‚æœ ESLint é€šè¿‡ï¼ŒæˆåŠŸ commitï¼Œå¦åˆ™ç»ˆæ­¢ commitã€‚</p> <p>ä½†æ˜¯åˆå­˜åœ¨ä¸€ä¸ªé—®é¢˜ï¼šæœ‰æ—¶å€™æˆ‘ä»¬æ˜æ˜åªæ”¹åŠ¨äº†ä¸€ä¸¤ä¸ªæ–‡ä»¶ï¼Œå´è¦å¯¹æ‰€æœ‰çš„æ–‡ä»¶æ‰§è¡Œ eslint --fixã€‚</p> <p>å‡å¦‚è¿™æ˜¯ä¸€ä¸ªå†å²é¡¹ç›®ï¼Œæˆ‘ä»¬åœ¨ä¸­é€”é…ç½®äº†<code>ESLint</code>è§„åˆ™ï¼Œé‚£ä¹ˆåœ¨æäº¤ä»£ç æ—¶ï¼Œä¹Ÿä¼šå¯¹å…¶ä»–æœªä¿®æ”¹çš„â€œå†å²â€æ–‡ä»¶éƒ½è¿›è¡Œæ£€æŸ¥ï¼Œå¯èƒ½ä¼šé€ æˆå¤§é‡æ–‡ä»¶å‡ºç° <code>ESLint</code>é”™è¯¯ï¼Œæ˜¾ç„¶ä¸æ˜¯æˆ‘ä»¬æƒ³è¦çš„ç»“æœã€‚
æˆ‘ä»¬è¦åšåˆ°åªç”¨<code>ESLint</code>ä¿®å¤è‡ªå·±æ­¤æ¬¡å†™çš„ä»£ç ï¼Œè€Œä¸å»å½±å“å…¶ä»–çš„ä»£ç ã€‚æ‰€ä»¥æˆ‘ä»¬è¿˜éœ€å€ŸåŠ©ä¸€ä¸ªç¥å¥‡çš„å·¥å…·<code>lint-staged</code>ã€‚</p> <ol start="2"><li>é…ç½®lint-staged</li></ol> <p><code>lint-staged</code> è¿™ä¸ªå·¥å…·ä¸€èˆ¬ç»“åˆ husky æ¥ä½¿ç”¨ï¼Œå®ƒå¯ä»¥è®© husky çš„ hook è§¦å‘çš„å‘½ä»¤åªä½œç”¨äº git addé‚£äº›æ–‡ä»¶ï¼ˆå³ git æš‚å­˜åŒºçš„æ–‡ä»¶ï¼‰ï¼Œè€Œä¸ä¼šå½±å“åˆ°å…¶ä»–æ–‡ä»¶ã€‚</p> <p>æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬ä½¿ç”¨ lint-staged ç»§ç»­ä¼˜åŒ–é¡¹ç›®ã€‚</p> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token function">pnpm</span> i lint-staged -D
</code></pre></div><p>åœ¨ <code>package.json</code> é‡Œå¢åŠ  lint-staged é…ç½®é¡¹</p> <div class="language-json extra-class"><pre class="language-json"><code><span class="token punctuation">{</span>
  ...
  <span class="token property">&quot;lint-staged&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">&quot;*.{js,ts,vue}&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
      <span class="token string">&quot;eslint --cache --fix&quot;</span><span class="token punctuation">,</span>
    <span class="token punctuation">]</span><span class="token punctuation">,</span>
     <span class="token property">&quot;*.{vue,less}&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
      <span class="token string">&quot;stylelint --fix  --custom-syntax postcss-less&quot;</span><span class="token punctuation">,</span>
    <span class="token punctuation">]</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>è¿™è¡Œå‘½ä»¤è¡¨ç¤ºï¼šåªå¯¹ <code>git æš‚å­˜åŒº</code>çš„ <code>.vueã€.jsã€.ts</code> æ–‡ä»¶æ‰§è¡Œ <code>eslint --fix</code>ã€‚</p> <ol start="3"><li>ä¿®æ”¹ <code>.husky/pre-commit</code> hook çš„è§¦å‘å‘½ä»¤ä¸ºï¼š<code>npx lint-staged</code> <img src="/assets/img/husky.0551ac8e.png" alt="husky"></li></ol> <p>è‡³æ­¤ï¼Œ<code>husky</code> å’Œ <code>lint-staged</code> ç»„åˆé…ç½®å®Œæˆã€‚</p> <p>ç°åœ¨æˆ‘ä»¬æäº¤ä»£ç æ—¶å°±ä¼šå˜æˆè¿™æ ·ï¼š</p> <p>å‡å¦‚æˆ‘ä»¬ä¿®æ”¹äº† src ç›®å½•ä¸‹çš„ <code>user.vue</code> ä»¥åŠ æ ¹ç›®å½•ä¸‹çš„ <code>vite.config.ts</code> æ–‡ä»¶ï¼Œç„¶å <code>git add ./src/</code>ï¼Œæœ€å <code>git commit -m &quot;test...&quot;</code>ï¼Œè¿™æ—¶å€™å°±ä¼šåªå¯¹ <code>user.vue</code> è¿™ä¸¤ä¸ªæ–‡ä»¶æ‰§è¡Œ <code>eslint --fix</code> å’Œ <code>stylelint --fix</code>ã€‚å¦‚æœ ESLint å’Œ stylelinté€šè¿‡ï¼ŒæˆåŠŸæäº¤ï¼Œå¦åˆ™ç»ˆæ­¢æäº¤ã€‚ä»è€Œä¿è¯äº†æˆ‘ä»¬æäº¤åˆ° Git ä»“åº“çš„ä»£ç éƒ½æ˜¯è§„èŒƒçš„ã€‚</p> <h2 id="ä»£ç æäº¤è§„èŒƒç»Ÿä¸€"><a href="#ä»£ç æäº¤è§„èŒƒç»Ÿä¸€" class="header-anchor">#</a> ä»£ç æäº¤è§„èŒƒç»Ÿä¸€</h2> <blockquote><p>ä¸ºäº†ä½¿å›¢é˜Ÿå¤šäººåä½œæ›´åŠ çš„è§„èŒƒï¼Œæ‰€ä»¥éœ€è¦æ¯æ¬¡åœ¨ git æäº¤çš„æ—¶å€™ï¼Œåšä¸€æ¬¡ç¡¬æ€§è§„èŒƒæäº¤ï¼Œè§„èŒƒ git çš„æäº¤ä¿¡æ¯ã€‚</p></blockquote> <p>å¦‚æœ git commit çš„æè¿°ä¿¡æ¯ç²¾å‡†ï¼Œåœ¨åæœŸç»´æŠ¤å’Œ Bug å¤„ç†æ—¶ä¼šå˜å¾—æœ‰æ®å¯æŸ¥ï¼Œé¡¹ç›®å¼€å‘å‘¨æœŸå†…è¿˜å¯ä»¥æ ¹æ®è§„èŒƒçš„æäº¤ä¿¡æ¯å¿«é€Ÿç”Ÿæˆå¼€å‘æ—¥å¿—ï¼Œä»è€Œæ–¹ä¾¿æˆ‘ä»¬è¿½è¸ªé¡¹ç›®å’ŒæŠŠæ§è¿›åº¦ã€‚</p> <p>è¿™é‡Œï¼Œæˆ‘ä»¬ä½¿ç”¨ç¤¾åŒºæœ€æµè¡Œã€æœ€çŸ¥åã€æœ€å—è®¤å¯çš„ <a href="https://github.com/angular/angular/commits/master" target="_blank" rel="noopener noreferrer">Angular å›¢é˜Ÿæäº¤è§„èŒƒ<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>ã€‚</p> <h3 id="é›†æˆ-commitizen-å®ç°æäº¤è§„èŒƒ"><a href="#é›†æˆ-commitizen-å®ç°æäº¤è§„èŒƒ" class="header-anchor">#</a> é›†æˆ <a href="https://github.com/commitizen/cz-cli" target="_blank" rel="noopener noreferrer">Commitizen<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> å®ç°æäº¤è§„èŒƒ</h3> <ol><li>å®‰è£…</li></ol> <div class="language-sh extra-class"><pre class="language-sh"><code><span class="token function">pnpm</span> i -D commitizen cz-customizable
</code></pre></div><ol start="2"><li>é…ç½®<code>package.json</code></li></ol> <details class="custom-block details"><summary>ç‚¹å‡»æŸ¥çœ‹ä»£ç </summary> <div class="language-json extra-class"><pre class="language-json"><code><span class="token punctuation">{</span>
  ...
  <span class="token property">&quot;scripts&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">&quot;commit&quot;</span><span class="token operator">:</span><span class="token string">&quot;cz&quot;</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>

  <span class="token property">&quot;config&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token property">&quot;commitizen&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token property">&quot;path&quot;</span><span class="token operator">:</span> <span class="token string">&quot;node_modules/cz-customizable&quot;</span>
      <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  ...
<span class="token punctuation">}</span>
</code></pre></div></details> <ol start="3"><li>è‡ªå®šä¹‰æç¤ºåˆ™æ·»åŠ  <code>.cz-config.js</code></li></ol> <details class="custom-block details"><summary>ç‚¹å‡»æŸ¥çœ‹ä»£ç </summary> <div class="language-js extra-class"><pre class="language-js"><code>module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token comment">// å¯é€‰ç±»å‹</span>
  <span class="token literal-property property">types</span><span class="token operator">:</span> <span class="token punctuation">[</span>
    <span class="token punctuation">{</span> <span class="token literal-property property">value</span><span class="token operator">:</span> <span class="token string">'feat'</span><span class="token punctuation">,</span> <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">'feat:     æ–°åŠŸèƒ½'</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">{</span> <span class="token literal-property property">value</span><span class="token operator">:</span> <span class="token string">'fix'</span><span class="token punctuation">,</span> <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">'fix:      ä¿®å¤'</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">{</span> <span class="token literal-property property">value</span><span class="token operator">:</span> <span class="token string">'docs'</span><span class="token punctuation">,</span> <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">'docs:     æ–‡æ¡£å˜æ›´'</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">{</span> <span class="token literal-property property">value</span><span class="token operator">:</span> <span class="token string">'style'</span><span class="token punctuation">,</span> <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">'style:    ä»£ç é£æ ¼ç›¸å…³(ä¸å½±å“ä»£ç è¿è¡Œçš„å˜åŠ¨)'</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">{</span> <span class="token literal-property property">value</span><span class="token operator">:</span> <span class="token string">'refactor'</span><span class="token punctuation">,</span> <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">'refactor: é‡æ„(æ—¢ä¸æ˜¯å¢åŠ featureï¼Œä¹Ÿä¸æ˜¯ä¿®å¤bug)'</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">{</span> <span class="token literal-property property">value</span><span class="token operator">:</span> <span class="token string">'perf'</span><span class="token punctuation">,</span> <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">'perf:     æ€§èƒ½ä¼˜åŒ–'</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">{</span> <span class="token literal-property property">value</span><span class="token operator">:</span> <span class="token string">'test'</span><span class="token punctuation">,</span> <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">'test:     æµ‹è¯•ç›¸å…³'</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">{</span> <span class="token literal-property property">value</span><span class="token operator">:</span> <span class="token string">'chore'</span><span class="token punctuation">,</span> <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">'chore:    ä¾èµ–æ›´æ–°/è„šæ‰‹æ¶é…ç½®ä¿®æ”¹ç­‰'</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">{</span> <span class="token literal-property property">value</span><span class="token operator">:</span> <span class="token string">'revert'</span><span class="token punctuation">,</span> <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">'revert:   æ’¤é”€ä¿®æ”¹'</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">{</span> <span class="token literal-property property">value</span><span class="token operator">:</span> <span class="token string">'workflow'</span><span class="token punctuation">,</span> <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">'workflow:    å·¥ä½œæµæ”¹è¿›'</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">{</span> <span class="token literal-property property">value</span><span class="token operator">:</span> <span class="token string">'ci'</span><span class="token punctuation">,</span> <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">'ci:    æŒç»­é›†æˆ'</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">{</span> <span class="token literal-property property">value</span><span class="token operator">:</span> <span class="token string">'types'</span><span class="token punctuation">,</span> <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">'types:    ç±»å‹å®šä¹‰æ–‡ä»¶æ›´æ”¹'</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">{</span> <span class="token literal-property property">value</span><span class="token operator">:</span> <span class="token string">'wip'</span><span class="token punctuation">,</span> <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">'wip:    å¼€å‘ä¸­'</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token comment">// æ¶ˆæ¯æ­¥éª¤</span>
  <span class="token literal-property property">messages</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">type</span><span class="token operator">:</span> <span class="token string">'è¯·é€‰æ‹©æäº¤ç±»å‹:'</span><span class="token punctuation">,</span>
    <span class="token literal-property property">customScope</span><span class="token operator">:</span> <span class="token string">'è¯·è¾“å…¥ä¿®æ”¹èŒƒå›´(å¯é€‰):'</span><span class="token punctuation">,</span>
    <span class="token literal-property property">subject</span><span class="token operator">:</span> <span class="token string">'è¯·ç®€è¦æè¿°æäº¤(å¿…å¡«):'</span><span class="token punctuation">,</span>
    <span class="token literal-property property">body</span><span class="token operator">:</span> <span class="token string">'è¯·è¾“å…¥è¯¦ç»†æè¿°(å¯é€‰):'</span><span class="token punctuation">,</span>
    <span class="token literal-property property">footer</span><span class="token operator">:</span> <span class="token string">'è¯·è¾“å…¥è¦å…³é—­çš„issue(å¯é€‰):'</span><span class="token punctuation">,</span>
    <span class="token literal-property property">confirmCommit</span><span class="token operator">:</span> <span class="token string">'ç¡®è®¤ä½¿ç”¨ä»¥ä¸Šä¿¡æ¯æäº¤ï¼Ÿ(y/n/e/h)'</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token comment">// è·³è¿‡é—®é¢˜</span>
  <span class="token literal-property property">skipQuestions</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">'body'</span><span class="token punctuation">,</span> <span class="token string">'footer'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token comment">// subjectæ–‡å­—é•¿åº¦é»˜è®¤æ˜¯72</span>
  <span class="token literal-property property">subjectLimit</span><span class="token operator">:</span> <span class="token number">72</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre></div></details> <ol start="4"><li>äº¤äº’ç•Œé¢æµ‹è¯•</li></ol> <details class="custom-block details"><summary>ç‚¹å‡»æŸ¥çœ‹å›¾ç‰‡</summary> <p><img src="/assets/img/cz.f1e46ba6.png" alt="commitizen"></p></details> <h3 id="é›†æˆ-commitlint-éªŒè¯æäº¤è§„èŒƒ"><a href="#é›†æˆ-commitlint-éªŒè¯æäº¤è§„èŒƒ" class="header-anchor">#</a> é›†æˆ commitlint éªŒè¯æäº¤è§„èŒƒ</h3> <p>åœ¨â€œä»£ç è§„èŒƒâ€ç« èŠ‚ï¼Œæˆ‘ä»¬å·²ç»è®²åˆ°è¿‡ï¼Œå°½ç®¡åˆ¶å®šäº†è§„èŒƒï¼Œä½†åœ¨å¤šäººåä½œçš„é¡¹ç›®ä¸­ï¼Œæ€»æœ‰äº›äººä¾æ—§æˆ‘è¡Œæˆ‘ç´ ï¼Œå› æ­¤æäº¤ä»£ç è¿™ä¸ªç¯èŠ‚ï¼Œæˆ‘ä»¬ä¹Ÿå¢åŠ ä¸€ä¸ªé™åˆ¶ï¼šåªè®©ç¬¦åˆè§„èŒƒçš„ commit message é€šè¿‡ï¼Œæˆ‘ä»¬å€ŸåŠ© <code>@commitlint/config-conventional</code> å’Œ <code>@commitlint/cli</code> æ¥å®ç°ã€‚</p> <ol><li>å®‰è£…</li></ol> <div class="language-sh extra-class"><pre class="language-sh"><code><span class="token function">pnpm</span> i @commitlint/config-conventional @commitlint/cli -D
</code></pre></div><ol start="2"><li>æ–°å¢é…ç½® <code>commitlint.config.js</code></li></ol> <div class="language-js extra-class"><pre class="language-js"><code>module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span> 
  <span class="token keyword">extends</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">'@commitlint/config-conventional'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>
</code></pre></div><ol start="3"><li>ä½¿ç”¨ husky çš„ <code>commit-msg</code> hook è§¦å‘éªŒè¯æäº¤ä¿¡æ¯çš„å‘½ä»¤</li></ol> <div class="language-sh extra-class"><pre class="language-sh"><code>npx husky <span class="token function">add</span> .husky/commit-msg <span class="token string">&quot;npx --no-install commitlint --edit <span class="token variable">$1</span>&quot;</span>
</code></pre></div><p>ä½¿ç”¨ husky å‘½ä»¤åœ¨ <code>.husky</code> ç›®å½•ä¸‹åˆ›å»º <code>commit-msg</code> æ–‡ä»¶ï¼Œå¹¶åœ¨æ­¤æ‰§è¡Œ <code>commit message</code> çš„éªŒè¯å‘½ä»¤ã€‚
<img src="/assets/img/commitlint.d000feec.png" alt="commitlint">
4. <code>commitlint</code> éªŒè¯</p> <ul><li>ä¸ç¬¦åˆè§„èŒƒçš„æäº¤ä¿¡æ¯
å¦‚ä¸‹å›¾ï¼Œæäº¤ä¿¡æ¯ <code>test commitlint</code> ä¸ç¬¦åˆè§„èŒƒï¼Œæäº¤å¤±è´¥ã€‚
<img src="/assets/img/test_commitlint.63c34a4b.png" alt="test commitlint"></li> <li>ç¬¦åˆè§„èŒƒçš„æäº¤ä¿¡æ¯
æäº¤ä¿¡æ¯ <code>chore: commitlint test</code> ç¬¦åˆè§„èŒƒï¼ŒæˆåŠŸæäº¤åˆ°ä»“åº“ã€‚</li></ul> <h2 id="å•å…ƒæµ‹è¯•"><a href="#å•å…ƒæµ‹è¯•" class="header-anchor">#</a> å•å…ƒæµ‹è¯•</h2> <blockquote><p>å•å…ƒæµ‹è¯•å…è®¸ä½ å°†ç‹¬ç«‹å•å…ƒçš„ä»£ç è¿›è¡Œéš”ç¦»æµ‹è¯•ï¼Œå®Œæ•´çš„æµ‹è¯•èƒ½ä¸ºä»£ç å’Œä¸šåŠ¡æä¾›è´¨é‡ä¿è¯ï¼Œå‡å°‘ Bug çš„å‡ºç°ã€‚é€šè¿‡ç¼–å†™ç»†è‡´ä¸”æœ‰æ„ä¹‰çš„æµ‹è¯•ï¼Œä½ èƒ½å¤Ÿæœ‰ä¿¡å¿ƒåœ¨æ„å»ºæ–°ç‰¹æ€§æˆ–é‡æ„å·²æœ‰ä»£ç çš„åŒæ—¶ï¼Œä¿æŒåº”ç”¨çš„åŠŸèƒ½å’Œç¨³å®šã€‚</p></blockquote> <h3 id="å®‰è£…ä¾èµ–-2"><a href="#å®‰è£…ä¾èµ–-2" class="header-anchor">#</a> å®‰è£…ä¾èµ–</h3> <div class="language-sh extra-class"><pre class="language-sh"><code><span class="token function">pnpm</span> i jest ts-jest @types/jest @jest/globals -D
</code></pre></div><h3 id="é…ç½®jest-config-jsæ–‡ä»¶"><a href="#é…ç½®jest-config-jsæ–‡ä»¶" class="header-anchor">#</a> é…ç½®<code>jest.config.js</code>æ–‡ä»¶</h3> <div class="language-js extra-class"><pre class="language-js"><code>module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">preset</span><span class="token operator">:</span> <span class="token string">'ts-jest'</span><span class="token punctuation">,</span>
    <span class="token literal-property property">testEnvironment</span><span class="token operator">:</span> <span class="token string">'node'</span><span class="token punctuation">,</span>
    <span class="token literal-property property">transform</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token string-property property">'^.+.ts$'</span><span class="token operator">:</span> <span class="token string">'ts-jest'</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token literal-property property">moduleFileExtensions</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">'js'</span><span class="token punctuation">,</span> <span class="token string">'ts'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token literal-property property">extensionsToTreatAsEsm</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">'.ts'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token comment">// testEnvironment: 'jsdom',</span>
    <span class="token literal-property property">modulePaths</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">'&lt;rootDir&gt;/src'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token literal-property property">collectCoverage</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
    <span class="token literal-property property">coverageDirectory</span><span class="token operator">:</span> <span class="token string">'coverage'</span><span class="token punctuation">,</span>
    <span class="token literal-property property">globals</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token string-property property">'ts-jest'</span><span class="token operator">:</span> <span class="token punctuation">{</span>
            <span class="token literal-property property">useESM</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
            <span class="token literal-property property">tsconfig</span><span class="token operator">:</span> <span class="token punctuation">{</span>
                <span class="token literal-property property">allowJs</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
            <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre></div><ol start="3"><li>æ‰§è¡Œå•å…ƒæµ‹è¯•</li></ol> <p>åœ¨æ ¹ç›®å½•ä¸‹ <code>package.json</code> æ–‡ä»¶çš„ scripts ä¸­ï¼Œæ·»åŠ ä¸€æ¡å•å…ƒæµ‹è¯•å‘½ä»¤ï¼š &quot;test:unit&quot;: &quot;jest&quot;ã€‚
æ‰§è¡Œå‘½ä»¤ <code>npm run test:unit</code> å³å¯è¿›è¡Œå•å…ƒæµ‹è¯•ï¼Œjest ä¼šæ ¹æ® <code>jest.config.js</code> é…ç½®æ–‡ä»¶å»æŸ¥æ‰¾ <strong>tests</strong> ç›®å½•ä¸‹çš„ .ts æ–‡ä»¶æˆ–å…¶ä»–ä»»æ„ç›®å½•ä¸‹çš„ .spec.ts å’Œ .test.ts æ–‡ä»¶ï¼Œç„¶åæ‰§è¡Œå•å…ƒæµ‹è¯•æ–¹æ³•ã€‚</p> <blockquote><p>ä½ å¯ä»¥åœ¨ <code>jest.config.js</code> é…ç½®æ–‡ä»¶ä¸­ï¼Œè‡ªç”±é…ç½®å•å…ƒæµ‹è¯•æ–‡ä»¶çš„ç›®å½•ã€‚</p></blockquote> <ul><li>å•å…ƒæµ‹è¯•å…¨éƒ¨é€šè¿‡æ—¶çš„ç»ˆç«¯æ˜¾ç¤ºä¿¡æ¯
<img src="/assets/img/jest.92dd7e35.png" alt="jest"></li> <li>å•å…ƒæµ‹è¯•æœªå…¨éƒ¨é€šè¿‡æ—¶çš„ç»ˆç«¯æ˜¾ç¤ºä¿¡æ¯
<img src="/assets/img/jest_fail.8444e923.png" alt="jest_fail">
å½“å•å…ƒæµ‹è¯•æ²¡æœ‰å…¨éƒ¨é€šè¿‡æ—¶ï¼Œæˆ‘ä»¬éœ€è¦æ ¹æ®æŠ¥é”™ä¿¡æ¯å»ä¼˜åŒ–å¯¹åº”ç»„ä»¶çš„ä»£ç ï¼Œè¿›ä¸€æ­¥æé«˜é¡¹ç›®å¥å£®æ€§ã€‚ä½†æ˜¯å†™å•å…ƒæµ‹è¯•æ˜¯ä»¶æ¯”è¾ƒç—›è‹¦çš„äº‹ï¼Œæˆ‘ä¸ªäººè§‰å¾—ä¹Ÿæ²¡å¿…è¦å…¨éƒ¨ç»„ä»¶éƒ½å†™å•å…ƒæµ‹è¯•ï¼Œæ ¹æ®é¡¹ç›®å®é™…æƒ…å†µæœ‰é’ˆå¯¹æ€§å»å†™å°±è¡Œäº†ã€‚</li></ul> <ol start="4"><li>å•å…ƒæµ‹è¯•çº¦æŸ</li></ol> <p>å‰é¢ï¼Œæˆ‘ä»¬ä½¿ç”¨ <code>husky</code> åœ¨ Git çš„ <code>pre-commit</code> å’Œ <code>commit-msg</code> é˜¶æ®µåˆ†åˆ«çº¦æŸä»£ç é£æ ¼è§„èŒƒå’Œæäº¤ä¿¡æ¯è§„èŒƒã€‚è¿™ä¸€æ­¥ï¼Œæˆ‘ä»¬åœ¨ <code>pre-push</code> é˜¶æ®µè¿›è¡Œå•å…ƒæµ‹è¯•ï¼Œåªæœ‰å•å…ƒæµ‹è¯•å…¨éƒ¨é€šè¿‡æ‰è®©ä»£ç  push åˆ°è¿œç«¯ä»“åº“ï¼Œå¦åˆ™ç»ˆæ­¢ pushã€‚</p> <p>ä½¿ç”¨ husky å‘½ä»¤åœ¨ <code>.husky</code> ç›®å½•ä¸‹è‡ªåŠ¨åˆ›å»º <code>pre-push</code> hook æ–‡ä»¶ï¼Œå¹¶åœ¨æ­¤æ‰§è¡Œå•å…ƒæµ‹è¯•å‘½ä»¤ <code>npm run test:unit</code>ã€‚</p> <div class="language-sh extra-class"><pre class="language-sh"><code>npx husky <span class="token function">add</span> .husky/pre-push <span class="token string">&quot;npm run test:unit <span class="token variable">$1</span>&quot;</span>
</code></pre></div><p>ç°åœ¨ï¼Œæˆ‘ä»¬åœ¨ git push æ—¶å°±èƒ½å…ˆè¿›è¡Œå•å…ƒæµ‹è¯•äº†ï¼Œåªæœ‰å•å…ƒæµ‹è¯•å…¨éƒ¨é€šè¿‡ï¼Œæ‰èƒ½æˆåŠŸ pushã€‚</p> <h2 id="å†™åœ¨æœ€å"><a href="#å†™åœ¨æœ€å" class="header-anchor">#</a> å†™åœ¨æœ€å</h2> <blockquote><p><code>å…¬ä¼—å·</code>ï¼š<code>å‰ç«¯å¼€å‘çˆ±å¥½è€…</code> ä¸“æ³¨åˆ†äº« <code>web</code> å‰ç«¯ç›¸å…³<code>æŠ€æœ¯æ–‡ç« </code>ã€<code>è§†é¢‘æ•™ç¨‹</code>èµ„æºã€çƒ­ç‚¹èµ„è®¯ç­‰ï¼Œå¦‚æœå–œæ¬¢æˆ‘çš„åˆ†äº«ï¼Œç»™ ğŸŸğŸŸ ç‚¹ä¸€ä¸ª<code>èµ</code> ğŸ‘ æˆ–è€… â•<code>å…³æ³¨</code> éƒ½æ˜¯å¯¹æˆ‘æœ€å¤§çš„æ”¯æŒã€‚</p></blockquote> <p>æ¬¢è¿<code>é•¿æŒ‰å›¾ç‰‡åŠ å¥½å‹</code>ï¼Œæˆ‘ä¼šç¬¬ä¸€æ—¶é—´å’Œä½ åˆ†äº«<code>å‰ç«¯è¡Œä¸šè¶‹åŠ¿</code>ï¼Œ<code>é¢è¯•èµ„æº</code>ï¼Œ<code>å­¦ä¹ é€”å¾„</code>ç­‰ç­‰ã€‚</p></div> <footer class="page-edit"><!----> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
      â†
      <a href="/blog/engineer/vue3-template.html" class="prev">
        ä» 0 æ­å»º vue3+vite+typescript ä¼ä¸šçº§é¡¹ç›®
      </a></span> <span class="next"><a href="/blog/engineer/eslintrc.html">
        ESLintä½¿ç”¨ã€åŸç†åŠé…ç½®è§„åˆ™è¯¦è§£
      </a>
      â†’
    </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.237e33b5.js" defer></script><script src="/assets/js/2.a6e094ff.js" defer></script><script src="/assets/js/4.9b118658.js" defer></script>
  </body>
</html>
